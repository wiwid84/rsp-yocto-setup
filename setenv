export ROOT="$(readlink -f $(dirname "$BASH_SOURCE"))/.."
SOURCEDIR="$ROOT/sources"
source $SOURCEDIR/poky/oe-init-build-env "$@"

# add meta-raspberrypi and meta-openembedded paths to bblayer.conf
cat >> "conf/bblayers.conf" <<EOF

# Generated by setup script
BBLAYERS += "${SOURCEDIR}/meta-raspberrypi"
BBLAYERS += "${SOURCEDIR}/meta-openembedded/meta-oe"
BBLAYERS += "${SOURCEDIR}/meta-openembedded/meta-networking"
BBLAYERS += "${SOURCEDIR}/meta-openembedded/meta-multimedia"
BBLAYERS += "${SOURCEDIR}/meta-openembedded/meta-python"
EOF

# add "commercial" licenses exception to local.conf
cat >> "conf/local.conf" <<EOF

# Generated by setup script
LICENSE_FLAGS_WHITELIST = "commercial"
EOF

# print usage example
cat <<EOM

### RaspberryPi build ###
 
MACHINE=raspberrypi bitbake rpi-hwup-image

EOM

